import glob, os

from activities.models import *
from coco.models import *
from geographies.models import *
from programs.models import *
from people.models import *
from videos.models import *

from boto.s3.connection import S3Connection
from boto.s3.key import Key
ACCESS_KEY = '01GE4NJEXRFQTBCFG782'
SECRET_KEY = 'bK8gt4siHBryH/cRagSMtcDPwNbfB0l2E/KXVhYy'
BUCKET_NAME = 'dg_farmerbook'

def get_farmer_list():
    person = Person.objects.filter(image_exists = True).values_list('id', flat = True)
    return person

def get_csp_list():
#    ACCESS_KEY = '01GE4NJEXRFQTBCFG782'
#    SECRET_KEY = 'bK8gt4siHBryH/cRagSMtcDPwNbfB0l2E/KXVhYy'
#    BUCKET_NAME = 'dg_farmerbook'
#    con = S3Connection(ACCESS_KEY, SECRET_KEY)
#    bucket = con.get_bucket(BUCKET_NAME)
#    rs = bucket.list("csp/")
#    csp_list = []
#    for key in rs:
#        try:
#            csp_id = int(key.name.split('/')[1].split('.')[0])   # 4 to remove 'csp/' and [0] to get the part before '.jpg'
#        except:
#            Error()
#        csp_list.append(csp_id)
    old_csp_list = [10000000000346L, 10000000000348L, 10000000000350L, 10000000000381L, 10000000000402L, 10000000000403L, 10000000000406L, 10000000000450L, 10000000019320L, 10000000019321L, 10000000019348L, 10000000019419L, 10000000019420L, 10000000019422L, 10000000019426L, 10000000019428L, 10000000019430L, 10000000019431L, 10000000019435L, 10000000019453L, 10000000019495L, 10000000019502L, 10000000019505L, 10000000019506L, 10000000019507L, 10000000019508L, 10000000019515L, 10000000019541L, 10000000019554L, 10000000019696L, 10000000019793L, 10000000019808L, 10000000019823L, 10000000019826L, 10000000019831L, 10000000019844L, 10000000019895L, 10000000019979L, 10000000020020L]
    csp_list = Animator.objects.filter(old_coco_id__in = old_csp_list).values_list('id', flat=True)
    return csp_list

def get_group_list():
#    ACCESS_KEY = '01GE4NJEXRFQTBCFG782'
#    SECRET_KEY = 'bK8gt4siHBryH/cRagSMtcDPwNbfB0l2E/KXVhYy'
#    BUCKET_NAME = 'dg_farmerbook'
#    con = S3Connection(ACCESS_KEY, SECRET_KEY)
#    bucket = con.get_bucket(BUCKET_NAME)
#    rs = bucket.list("group/")
#    group_list = []
#    for key in rs:
#        try:
#            group_id = int(key.name.split('/')[1].split('.')[0])   # 4 to remove 'csp/' and [0] to get the part before '.jpg'
#        except:
#            Error()
#        group_list.append(group_id)
#    updated on 14/9/2012 
    old_group_list = [10000000000090L, 10000000000093L, 10000000000094L, 10000000000095L, 10000000000096L, 10000000000097L, 10000000000098L, 10000000000099L, 10000000000100L, 10000000000105L, 10000000000106L, 10000000000107L, 10000000000114L, 10000000000115L, 10000000000116L, 10000000000119L, 10000000000120L, 10000000000121L, 10000000000122L, 10000000000159L, 10000000000169L, 10000000000170L, 10000000000177L, 10000000000179L, 10000000000181L, 10000000000182L, 10000000000183L, 10000000000184L, 10000000000185L, 10000000000186L, 10000000000189L, 10000000000190L, 10000000000201L, 10000000000203L, 10000000000225L, 10000000000226L, 10000000000227L, 10000000000228L, 10000000000233L, 10000000000238L, 10000000000288L, 10000000000306L, 10000000000307L, 10000000000308L, 10000000000309L, 10000000000310L, 10000000000328L, 10000000000329L, 10000000000357L, 10000000000360L, 10000000000366L, 10000000000375L, 10000000000383L, 10000000000394L, 10000000000399L, 10000000000400L, 10000000000402L, 10000000000403L, 10000000000407L, 10000000000408L, 10000000000413L, 10000000000439L, 10000000000445L, 10000000000446L, 10000000000450L, 10000000000451L, 10000000000452L, 10000000000456L, 10000000000470L, 10000000000473L, 10000000000494L, 10000000000499L, 10000000000500L, 10000000000501L, 10000000000503L, 10000000000504L, 10000000000511L, 10000000000522L, 10000000000526L, 10000000000527L, 10000000000529L, 10000000000530L, 10000000000537L, 10000000000540L, 10000000000541L, 10000000000544L, 10000000000545L, 10000000000546L, 10000000000560L, 10000000000586L, 10000000000602L, 10000000000609L, 10000000000610L, 10000000000611L, 10000000000612L, 10000000000613L, 10000000000614L, 10000000000616L, 10000000000626L, 10000000000645L, 10000000000648L, 10000000000649L, 10000000000651L, 10000000000652L, 10000000000676L, 10000000000678L, 10000000000680L, 10000000000685L, 10000000000686L, 10000000000691L, 10000000000711L, 10000000000713L, 10000000000714L, 10000000000717L, 10000000000719L, 10000000000721L, 10000000000722L, 10000000000728L, 10000000000729L, 10000000000730L, 10000000000742L, 10000000000772L, 10000000000774L, 10000000000777L, 10000000000778L, 10000000000782L, 10000000000783L, 10000000000784L, 10000000000785L, 10000000000786L, 10000000000789L, 10000000000793L, 10000000000794L, 10000000000799L, 10000000000801L, 10000000000802L, 10000000000809L, 10000000000810L, 10000000000811L, 10000000000814L, 10000000000816L, 10000000000829L, 10000000000830L, 10000000000831L, 10000000000832L, 10000000000833L, 10000000000839L, 10000000000843L, 10000000000848L, 10000000000855L, 10000000000860L, 10000000000861L, 10000000000890L, 10000000000891L, 10000000000895L, 10000000000908L, 10000000000909L, 10000000000919L, 10000000000920L, 10000000000952L, 10000000000955L, 10000000000956L, 10000000000980L, 10000000000981L, 10000000000996L, 10000000000997L, 10000000000998L, 10000000001000L, 10000000001038L, 10000000001040L, 10000000001041L, 10000000001042L, 10000000001043L, 10000000001056L, 10000000001057L, 10000000001058L, 10000000001059L, 10000000001061L, 10000000001062L, 10000000001063L, 10000000017400L, 10000000017401L, 10000000017402L, 10000000017403L, 10000000017404L, 10000000017405L, 10000000017406L, 10000000017407L, 10000000017408L, 10000000017409L, 10000000017410L, 10000000017411L, 10000000017412L, 10000000017413L, 10000000017414L, 10000000017416L, 10000000017417L, 10000000017419L, 10000000017420L, 10000000018749L, 10000000019092L, 10000000019093L, 10000000019103L, 10000000019104L, 10000000019105L, 10000000019108L, 10000000019898L, 10000000019916L, 10000000019926L, 10000000019929L, 10000000019939L, 10000000019944L, 10000000019945L, 10000000019948L, 10000000019950L, 10000000019951L, 10000000019954L, 10000000019956L, 10000000019958L, 10000000019959L, 10000000019963L, 10000000019964L, 10000000019966L, 10000000019987L, 10000000019988L, 10000000019991L, 10000000019995L, 10000000020011L, 10000000020012L, 10000000020013L, 10000000020024L, 10000000020025L, 10000000020030L, 10000000020031L, 10000000020033L, 10000000020055L, 10000000020083L, 10000000020111L, 10000000020118L, 10000000020122L, 10000000020123L, 10000000020124L, 10000000020125L, 10000000020137L, 10000000020138L, 10000000020139L, 10000000020173L, 10000000020201L, 10000000020206L, 10000000020234L, 10000000020240L, 10000000020241L, 10000000020246L, 10000000020247L, 10000000020254L, 10000000020259L, 10000000020261L, 10000000020262L, 10000000020276L, 10000000020302L, 10000000020306L, 10000000020312L, 10000000020330L, 10000000020333L, 10000000020338L, 10000000020356L, 10000000020433L, 10000000020477L, 10000000020480L, 10000000020495L, 10000000020499L, 10000000020538L, 10000000020539L, 10000000020542L, 10000000020550L, 10000000020554L, 10000000020555L, 10000000020556L, 10000000020566L, 10000000020571L, 10000000020583L, 10000000020584L, 10000000020586L, 10000000020588L, 10000000020589L, 10000000020596L, 10000000020626L, 10000000020639L, 10000000020642L, 10000000020646L, 10000000020651L, 10000000020654L, 10000000020656L, 10000000020671L, 10000000020672L, 10000000020674L, 10000000020675L, 10000000020676L, 10000000020677L, 10000000020685L, 10000000020686L, 10000000020689L, 10000000020690L, 10000000020691L, 10000000020693L, 10000000020694L, 10000000020695L, 10000000020697L, 10000000020712L, 10000000020713L, 10000000020714L, 10000000020715L, 10000000020716L, 10000000020717L, 10000000020718L, 10000000020719L, 10000000020720L, 10000000020724L, 10000000020727L, 10000000020728L, 10000000020729L, 10000000020731L, 10000000020732L, 10000000020757L, 10000000020763L, 10000000020764L, 10000000020765L, 10000000020767L, 10000000020768L, 10000000020769L, 10000000020770L, 10000000020771L, 10000000020772L, 10000000020773L, 10000000020805L, 10000000020806L, 10000000020807L, 10000000020850L, 10000000020854L, 10000000021048L, 10000000021049L, 10000000021069L, 10000000021070L, 10000000021072L, 10000000021080L, 10000000021100L, 10000000021105L, 10000000021109L, 10000000021130L, 10000000021134L, 10000000021135L, 10000000021137L, 10000000021139L, 10000000021142L, 10000000021177L, 10000000021178L, 10000000021179L, 10000000021180L, 10000000021182L, 10000000021183L, 10000000021202L, 10000000021203L, 10000000021204L, 10000000021269L, 10000000021270L, 10000000021271L, 10000000021272L, 10000000021277L, 10000000021278L, 10000000021281L, 10000000021282L, 10000000021284L, 10000000021285L, 10000000021287L, 10000000021288L, 10000000021296L, 10000000021298L, 10000000021304L, 10000000021313L, 10000000021314L, 10000000021316L, 10000000021342L, 10000000021343L, 10000000021346L, 10000000021347L, 10000000021380L, 10000000021382L, 10000000021422L, 10000000021423L, 10000000021424L, 10000000021456L, 10000000021459L, 10000000021464L, 10000000021466L, 10000000021468L, 10000000021469L, 10000000021471L, 10000000021472L, 10000000021483L, 10000000021485L, 10000000021502L, 10000000021503L, 10000000021504L, 10000000021516L, 10000000021520L, 10000000021526L, 10000000021527L, 10000000021528L, 10000000021529L, 10000000021550L, 10000000021565L, 10000000021568L, 10000000021577L, 10000000021601L, 10000000021603L, 10000000021604L, 10000000021609L, 10000000021614L, 10000000021645L, 10000000021651L, 10000000021652L, 10000000021658L, 10000000021676L, 10000000021699L, 10000000021700L, 10000000021718L, 10000000021719L, 10000000021721L, 10000000021722L, 10000000021723L, 10000000021725L, 10000000021726L, 10000000021758L, 10000000021772L, 10000000021773L, 10000000021781L, 10000000021784L, 10000000021803L, 10000000021804L, 10000000021805L, 10000000021806L, 10000000021807L, 10000000021811L, 10000000021825L, 10000000021826L, 10000000021833L, 10000000021835L, 10000000021851L, 10000000021856L, 10000000021861L, 10000000021862L, 10000000021868L, 10000000021869L, 10000000021874L, 10000000021875L, 10000000021876L, 10000000021929L, 10000000021941L, 10000000021950L, 10000000021956L, 10000000021985L, 10000000022122L, 10000000022209L, 10000000022213L, 10000000022214L, 10000000022215L, 10000000022221L, 10000000022223L, 10000000022244L, 10000000022245L, 10000000022250L, 10000000022251L, 10000000022260L, 10000000022267L, 10000000022309L, 10000000022324L, 10000000022326L, 10000000022343L, 10000000022344L, 10000000022362L, 10000000022363L, 10000000022364L, 10000000022409L, 10000000022410L, 10000000022411L, 10000000022412L, 10000000022423L, 10000000022425L, 10000000022426L, 10000000022427L, 10000000022428L, 10000000022429L, 10000000022434L, 10000000022435L, 10000000022436L, 10000000022441L, 10000000022442L, 10000000022443L, 10000000022450L, 10000000022451L, 10000000022462L, 10000000022466L, 10000000022467L, 10000000022468L, 10000000022476L, 10000000022479L, 10000000022480L, 10000000022482L, 10000000022483L, 10000000022485L, 10000000022487L, 10000000022489L, 10000000022490L, 10000000022491L, 10000000022493L, 10000000022494L, 10000000022505L, 10000000022506L, 10000000022512L, 10000000022513L, 10000000022514L, 10000000022515L, 10000000022516L, 10000000022517L, 10000000022520L, 10000000022521L, 10000000022522L, 10000000022523L, 10000000022524L, 10000000022526L, 10000000022539L, 10000000022540L, 10000000022546L, 10000000022557L, 10000000022561L, 10000000022562L, 10000000022563L, 10000000022564L, 10000000022596L, 10000000022598L, 10000000022599L, 10000000022654L, 10000000022690L, 10000000022696L, 10000000022713L, 10000000022722L, 10000000022723L, 10000000022724L, 10000000022725L, 10000000022726L, 10000000022728L, 10000000022729L, 10000000022730L, 10000000022731L, 10000000022800L, 10000000022806L, 10000000022824L, 10000000022832L, 10000000022833L, 10000000022834L, 10000000022835L, 10000000022856L, 10000000022857L, 10000000022863L, 10000000022864L, 10000000022882L, 10000000022883L, 10000000022889L, 10000000022894L, 10000000022895L, 10000000022896L, 10000000022898L, 10000000022906L, 10000000022908L, 10000000022946L, 10000000022952L, 10000000022959L, 10000000022962L, 10000000022964L, 10000000022973L, 10000000023012L, 10000000023033L, 10000000023034L, 10000000023035L, 10000000023036L, 10000000023037L, 10000000023041L, 10000000023042L, 10000000023043L, 10000000023044L, 10000000023045L, 10000000023050L, 10000000023059L, 10000000023060L, 10000000023061L, 10000000023062L, 10000000023063L, 10000000023064L, 10000000023065L, 10000000023066L, 10000000023071L, 10000000023072L, 10000000023077L, 10000000023079L, 10000000023083L, 10000000023154L, 10000000023155L, 10000000023157L, 10000000023170L, 10000000023173L, 10000000023175L, 10000000023176L, 10000000023179L, 10000000023180L, 10000000023181L, 10000000023182L, 10000000023183L, 10000000023184L, 10000000023185L, 10000000023186L, 10000000023187L, 10000000023188L, 10000000023193L, 10000000023217L, 10000000023227L, 10000000023234L, 10000000023252L, 10000000023265L, 10000000023266L, 10000000023269L, 10000000023270L, 10000000023271L, 10000000023273L, 10000000023276L, 10000000023290L, 10000000023291L, 10000000023295L, 10000000023296L, 10000000023311L, 10000000023357L, 10000000023368L, 10000000023369L, 10000000023370L, 10000000023371L, 10000000023411L, 10000000023412L, 10000000023413L, 10000000023414L, 10000000023415L, 10000000023416L, 10000000023441L, 10000000023460L, 10000000023461L, 10000000023462L, 10000000023463L, 10000000023464L, 10000000023465L, 10000000023466L, 10000000023478L, 10000000023479L, 10000000023485L, 10000000023486L, 10000000023487L, 10000000023488L, 10000000023489L, 10000000023490L, 10000000023505L, 10000000023506L, 10000000023508L, 10000000023510L, 10000000023511L, 10000000023512L, 10000000023513L, 10000000023514L, 10000000023515L, 10000000023522L, 10000000023523L, 10000000023524L, 10000000023525L, 10000000023532L, 10000000023533L, 10000000023534L, 10000000023535L, 10000000023537L, 10000000023538L, 10000000023539L, 10000000023541L, 10000000023577L, 10000000023578L, 10000000023579L, 10000000023580L, 10000000023588L, 10000000023589L, 10000000023590L, 10000000023591L, 10000000023592L, 10000000023607L, 10000000023656L, 10000000023657L, 10000000023658L, 10000000023660L, 10000000023662L, 10000000023663L, 10000000023664L, 10000000023667L, 10000000023668L, 10000000023669L, 10000000023674L, 10000000023675L, 10000000023677L, 10000000023679L, 10000000023682L, 10000000023691L, 10000000023692L, 10000000023694L, 10000000023695L, 10000000023696L, 10000000023729L, 10000000023730L, 10000000023740L, 10000000023741L, 10000000023746L, 10000000023755L, 10000000023756L, 10000000023766L, 10000000023799L, 10000000023806L, 10000000023807L, 10000000023808L, 10000000023809L, 10000000023810L, 10000000023836L, 10000000023837L, 10000000023841L, 10000000023842L, 10000000023843L, 10000000023850L, 10000000023851L, 10000000023852L, 10000000023853L, 10000000023872L, 10000000023876L, 10000000023878L, 10000000023884L, 10000000023899L, 10000000023900L, 10000000024109L, 10000000024112L, 10000000024113L, 10000000024121L, 10000000024147L, 10000000024148L, 10000000024149L, 10000000024150L, 18000000066L, 26000001027L, 26000001056L, 26000001087L, 26000001103L, 26000001903L, 26000001916L, 26000001929L, 26000001941L, 26000001953L, 26000001993L, 26000004803L, 26000005062L, 26000005078L, 26000005205L, 26000005293L, 26000007899L, 26000007986L, 26000008062L, 26000011761L, 26000013021L, 26000013037L, 26000013052L, 26000014591L, 26000014679L, 26000016574L, 26000017116L, 26000017142L, 28000002096L, 29000001686L, 29000003043L, 29000003080L, 29000005343L, 34000003018L, 34000005146L, 34000005814L, 34000005826L, 34000005873L, 37000007038L, 37000007051L, 37000007052L, 37000007153L, 37000007704L, 37000008310L, 37000008412L, 37000008421L, 37000008590L, 37000008798L, 37000009069L, 37000009996L, 37000010174L, 37000010337L, 37000010571L, 37000010771L, 37000010772L, 37000010773L, 37000011531L, 37000011545L, 37000011654L, 37000011995L, 37000019264L, 37000019309L, 37000019738L, 37000028473L, 37000037139L, 37000039774L, 37000039799L, 37000040101L, 37000045182L, 37000045195L, 40000001718L, 40000001772L, 40000001792L, 40000001806L, 40000001822L, 40000001837L, 40000001992L, 40000002114L, 40000002130L, 40000002147L, 40000005654L, 40000006028L, 40000007640L, 40000008891L, 40000010126L, 40000012536L, 40000012537L, 40000015336L, 40000015369L, 40000016589L, 40000017428L, 40000019107L, 40000026916L, 40000039050L, 40000040090L, 40000040189L, 40000041211L, 46000001603L, 46000001604L, 46000001605L, 46000001606L, 46000001607L, 46000001608L, 46000001843L, 46000001844L, 46000013334L, 47000001124L, 47000001125L, 47000001127L, 47000001534L, 47000002323L, 47000002397L, 47000002416L, 47000002434L, 47000007767L, 47000007787L, 47000007803L, 47000007818L, 47000007846L, 47000007860L, 47000007883L, 47000007896L, 47000008101L, 47000051354L, 47000051355L, 47000051357L, 47000051358L, 47000052365L, 47000052366L, 47000052367L, 47000056972L, 47000056973L, 47000056974L, 47000056975L, 47000057055L, 47000057070L, 47000057086L, 47000057148L, 47000057164L, 47000057180L, 47000057196L, 47000057211L, 47000057227L, 47000057243L, 52000001094L, 52000001171L, 52000001185L, 52000001197L, 52000001209L, 52000001375L, 52000001390L, 52000001421L, 52000001435L, 52000001484L, 52000001623L, 52000001639L, 55000001001L, 55000001014L, 55000001077L, 55000001123L, 55000001140L, 55000001843L, 55000001871L, 55000001887L, 55000002059L, 55000002067L, 55000002075L, 55000002089L, 55000002181L, 55000002227L, 55000002243L, 55000002293L, 55000002308L, 55000002323L, 55000002337L, 55000002351L, 58000001002L, 58000001027L, 58000001038L, 58000001054L, 58000001065L, 58000001498L, 58000001509L, 6000001077L, 6000001137L, 6000001152L, 6000001236L, 6000002212L, 6000002558L, 6000005553L, 6000006279L, 6000008488L, 6000008504L, 6000008525L, 6000009648L, 6000009669L, 6000009686L, 6000019503L, 6000022852L, 6000022883L, 6000022914L, 6000022927L, 6000022943L, 6000027561L, 6000038914L, 6000038941L, 6000040128L, 61000001125L, 61000001250L, 61000001263L, 61000001274L, 61000001435L, 61000001482L, 61000001705L, 7000001190L, 7000001208L, 7000001251L, 7000001267L]
    group_list = PersonGroup.objects.filter(old_coco_id__in = old_group_list).values_list('id', flat = True)
    return group_list

def get_village_list():
#    ACCESS_KEY = '01GE4NJEXRFQTBCFG782'
#    SECRET_KEY = 'bK8gt4siHBryH/cRagSMtcDPwNbfB0l2E/KXVhYy'
#    BUCKET_NAME = 'dg_farmerbook'
#    con = S3Connection(ACCESS_KEY, SECRET_KEY)
#    bucket = con.get_bucket(BUCKET_NAME)
#    rs = bucket.list("village/")
#    village_list = []
#    for key in rs:
#        try:
#            village_id = int(key.name.split('/')[1].split('.')[0])   # 4 to remove 'csp/' and [0] to get the part before '.jpg'
#        except:
#            print key.name
#            Error()
#        village_list.append(village_id)
#   updated on 13/9/2012
    old_village_list = [10000000000031L, 10000000000043L, 10000000000044L, 10000000000045L, 10000000000048L, 10000000000050L, 10000000000052L, 10000000000053L, 10000000000067L, 10000000000074L, 10000000000077L, 10000000000078L, 10000000000092L, 10000000000093L, 10000000000096L, 10000000000097L, 10000000000099L, 10000000000100L, 10000000000101L, 10000000000102L, 10000000000103L, 10000000000112L, 10000000000119L, 10000000000120L, 10000000000122L, 10000000000124L, 10000000000215L, 10000000000217L, 10000000000228L, 10000000000230L, 10000000000232L, 10000000000241L, 10000000000242L, 10000000000249L, 10000000000251L, 10000000000252L, 10000000000254L, 10000000000255L, 10000000000257L, 10000000000260L, 10000000000261L, 10000000000264L, 10000000000265L, 10000000000270L, 10000000000271L, 10000000000272L, 10000000000274L, 10000000000275L, 10000000000276L, 10000000000277L, 10000000000279L, 10000000000280L, 10000000000281L, 10000000000283L, 10000000000284L, 10000000000285L, 10000000000286L, 10000000000287L, 10000000000299L, 10000000000304L, 10000000000305L, 10000000000306L, 10000000000307L, 10000000000309L, 10000000000313L, 10000000000341L, 10000000000342L, 10000000000389L, 10000000000393L, 10000000000394L, 10000000000406L, 10000000000407L, 10000000000408L, 10000000000410L, 10000000000412L, 10000000000413L, 10000000000414L, 10000000000417L, 10000000000418L, 10000000000420L, 10000000000421L, 10000000000422L, 10000000000424L, 10000000000425L, 10000000000426L, 10000000000504L, 10000000000507L, 10000000000509L, 10000000000514L, 10000000000532L, 10000000000536L, 10000000000537L, 10000000000538L, 10000000018674L, 10000000018676L, 10000000019834L, 10000000019835L, 10000000019841L, 10000000019842L, 10000000019843L, 10000000019854L, 10000000019860L, 10000000019862L, 10000000019864L, 10000000019865L, 10000000019873L, 10000000019874L, 10000000019880L, 10000000019882L, 10000000019883L, 10000000019889L, 10000000019891L, 10000000019901L, 10000000019902L, 10000000019905L, 10000000019909L, 10000000019913L, 10000000019918L, 10000000019922L, 10000000019929L, 10000000019942L, 10000000019945L, 10000000019946L, 10000000019954L, 10000000019959L, 10000000019967L, 10000000019968L, 10000000019969L, 10000000019975L, 10000000019978L, 10000000019985L, 10000000019988L, 10000000020020L, 10000000020029L, 10000000020036L, 10000000020040L, 10000000020047L, 10000000020078L, 10000000020079L, 10000000020082L, 10000000020084L, 10000000020085L, 10000000020090L, 10000000020092L, 10000000020093L, 10000000020104L, 10000000020105L, 10000000020106L, 10000000020110L, 10000000020119L, 10000000020120L, 10000000020154L, 10000000020156L, 10000000020158L, 10000000020183L, 10000000020184L, 10000000020198L, 10000000020199L, 10000000020222L, 10000000020242L, 10000000020243L, 10000000020270L, 10000000020271L, 10000000020274L, 10000000020276L, 10000000020345L, 10000000020353L, 10000000020369L, 10000000020370L, 10000000020381L, 10000000020390L, 10000000020391L, 10000000020393L, 10000000020394L, 10000000020411L, 10000000020412L, 10000000020439L, 10000000020444L, 10000000020448L, 10000000020452L, 10000000020453L, 10000000020455L, 10000000020483L, 10000000020484L, 10000000020485L, 10000000020487L, 10000000020488L, 10000000020489L, 10000000020490L, 10000000020492L, 10000000020498L, 10000000020499L, 10000000020500L, 10000000020506L, 10000000020508L, 10000000020509L, 10000000020510L, 10000000020511L, 10000000020517L, 10000000020519L, 10000000020538L, 10000000020539L, 10000000020540L, 10000000020555L, 10000000020556L, 10000000020557L, 10000000020562L, 10000000020563L, 10000000020568L, 10000000020571L, 10000000020572L, 10000000020594L, 10000000020617L, 10000000020625L, 10000000020647L, 10000000020649L, 26000001003L, 26000001007L, 26000001009L, 26000011729L, 26000013020L, 34000003805L, 37000001270L, 46000001002L, 46000001835L, 47000001038L, 47000001044L, 47000001122L, 47000051353L, 47000052364L, 47000056970L, 47000062452L, 7000001207L, 47000040575L]
    village_list = Village.objects.filter(old_coco_id__in = old_village_list).values_list('id', flat=True)
    return village_list

def get_partner_list():
#    ACCESS_KEY = '01GE4NJEXRFQTBCFG782'
#    SECRET_KEY = 'bK8gt4siHBryH/cRagSMtcDPwNbfB0l2E/KXVhYy'
#    BUCKET_NAME = 'dg_farmerbook'
#    con = S3Connection(ACCESS_KEY, SECRET_KEY)
#    bucket = con.get_bucket(BUCKET_NAME)
#    rs = bucket.list("partner/")
#    partner_list = []
#    for key in rs:
#        try:
#            partner_id = int(key.name.split('/')[1].split('.')[0])   # 4 to remove 'csp/' and [0] to get the part before '.jpg'
#        except:
#            Error()
#        partner_list.append(partner_id)
    old_partner_list = [10000000000001L, 10000000000002L, 10000000000003L, 10000000000004L, 10000000000007L, 10000000000008L, 10000000000009L, 10000000000010L, 10000000000011L, 10000000000012L, 10000000000013L]
    partner_list = Partner.objects.filter(old_coco_id__in = old_partner_list).values_list('id', flat = True)
    return partner_list    

if __name__ == "__main__":
    partner_list = get_group_list()
    print partner_list
    print len(partner_list)
