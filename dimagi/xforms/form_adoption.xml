<h:html xmlns:h="http://www.w3.org/1999/xhtml" xmlns:orx="http://openrosa.org/jr/xforms" xmlns="http://www.w3.org/2002/xforms" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:jr="http://openrosa.org/javarosa">
	<h:head>
		<h:title>Adoption</h:title>
		<model>
			<instance>
				<data xmlns:jrm="http://dev.commcarehq.org/jr/xforms" xmlns="http://openrosa.org/formdesigner/58d4e7979e6c8b8b2bddce6845b02fd51d89acc8" uiVersion="1" version="1" name="Adoption">
					<selected_date/>
					<selected_village/>
					<selected_group/>
					<selected_mediator/>
					<selected_person/>
					<selected_video/>
					<listofvideos/>
					<form_done/>
					<person_count/>
				</data></instance>
			
			<instance id="village" src="jr://fixture/item-list:village"/>
			<instance id="group" src="jr://fixture/item-list:group"/>
			<instance id="mediator" src="jr://fixture/item-list:mediator"/>
			<instance id="video" src="jr://fixture/item-list:video"/>
			<instance id="unique_video" src="jr://fixture/item-list:unique_video"/>
			<instance id="casedb" src="jr://instance/casedb"/>
			
			<bind nodeset="/data/selected_date" type="xsd:date" required="true()"/>
			
			<bind nodeset="/data/selected_village" required="true()"/>
			<bind nodeset="/data/selected_group" required="true()"/>
			<bind nodeset="/data/selected_person" required="true()" />
			<bind nodeset="/data/selected_video" required="true()" />
			<bind nodeset="/data/selected_mediator" required="true()"/>
			<bind nodeset="/data/listofvideos"  calculate="if(/data/selected_person = '','', instance('casedb')/casedb/case[id =/data/selected_person]/videos_seen)" /> 
			<bind nodeset="/data/form_done"/>
			
			
			<itext>
				<translation lang="en" >
					<text id="form_done-label">
						<value>Your form has been completed. Press Done to continue</value>
					</text>
					<text id="selected_village-label">
						<value>Village</value>
					</text>
					<text id="selected_mediator-label">
						<value>Mediator</value>
					</text>
					<text id="selected_group-label">
						<value>Group</value>
					</text>
					<text id="selected_video-label">
						<value>Video</value>
					</text>
					<text id="selected_person-label">
						<value>Person</value>
					</text>
					<text id="date-label">
						<value>Date</value>
					</text>
				</translation>
				<translation lang="tel" default="">
					<text id="form_done-label">
						<value>?? ???? ???? ????????. ?????? ???</value>
					</text>
					<text id="selected_village-label">
						<value>???????</value>
					</text>
					<text id="selected_mediator-label">
						<value>?????????</value>
					</text>
					<text id="selected_group-label">
						<value>?????? ????</value>
					</text>
					<text id="selected_video-label">
						<value>?????? ????</value>
					</text>
					<text id="selected_person-label">
						<value>????</value>
					</text>
					<text id="date-label">
						<value>????</value>
					</text>
				</translation>
			</itext>
		</model>
	</h:head>
	<h:body>
		<input ref="/data/selected_date">
			<label ref="jr:itext('date-label')"/>
		</input>
		<select1 ref="/data/selected_village">
			<label ref="jr:itext('selected_village-label')"/>
			<itemset nodeset="instance('village')/village_list/village[seen = '1']">
				<label ref="name"/>
				<value ref="id"/>
			</itemset>
		</select1>
		<select1 ref="/data/selected_mediator">
			<label ref="jr:itext('selected_mediator-label')"/>
			<itemset nodeset="instance('mediator')/mediator_list/mediator[village_id=/data/selected_village]">
				<label ref="name"/>
				<value ref="id"/>
			</itemset>
		</select1>
		<select1 ref="/data/selected_group">
			<label ref="jr:itext('selected_group-label')"/>
			<itemset nodeset="instance('group')/group_list/group[village_id=/data/selected_village and seen = '1']">
				<label ref="name"/>
				<value ref="id"/>
			</itemset>
		</select1>
		
		<select1 ref="/data/selected_person">
			<label ref="jr:itext('selected_person-label')"/>
			<itemset nodeset=" instance('casedb')/casedb/case[group_id=/data/selected_group and videos_seen != ''] " >
				<label ref="case_name"/>
				<value ref="id"/>
			</itemset>
		</select1>
		<select1 ref="/data/selected_video">
			<label ref="jr:itext('selected_video-label')"/>
			<itemset nodeset="instance('unique_video')/unique_video_list/unique_video[selected(/data/listofvideos,id) ]">
				<label ref="name"/>
				<value ref="id"/>
			</itemset>
		</select1>
		<trigger ref="/data/form_done">
			<label ref="jr:itext('form_done-label')"/>
		</trigger>
		</h:body>
</h:html>