define(["require","app/libs/DigitalGreenDataFeed","app/libs/DataModel","framework/Util"],function(e){var t=e("app/libs/DigitalGreenDataFeed"),n=e("app/libs/DataModel"),r=e("framework/Util"),i=t.extend({_filters:undefined,constructor:function(e){this.base("api/elasticSearch/"),this._filters={};var t=this._dataModel,n=t.addSubModel("collections",!0);this.addInputParam("searchString",!1,0,!0),this.addInputParam("offset",!0,0,!0),this.addInputParam("limit",!0,0,!0),this.addInputParam("filters",!1,null,!0,n),this.addInputParam("order_by",!1,null,!0,n),e!=-1&&this.addInputParamCacheClear("language__name",n)},fetch:function(e,t){e==undefined&&(e=0),t==undefined&&(t=12),this.setInputParam("offset",e*t,!0),this.setInputParam("limit",t,!0),this.base()},_processData:function(e){this.base(e);var t=this._dataModel,n=t.get("collections"),r=e.meta.limit,i=e.meta.offset/e.meta.limit;t.set("totalCount",e.meta.total_count);var s=e.objects,o=i*r,u=e.facets;return t.set("facets",e.facets),n.addSubset(s,o),s},setFilterStatus:function(e,t,n){var i=this._filters;i[e]==undefined&&(i[e]=[]);var s=i[e].indexOf(t),o=s!=-1;if(n&&o||!n&&!o)return!1;n?i[e].push(t):i[e].splice(s,1);var u=r.Object.clone(i);return this.setInputParam("filters",u),!0},clearFilters:function(){var e=!1,t=this._filters,n;for(n in t){var r=t[n],i=r.length;if(i>0){e=!0;break}}return this._filters={},e},getTotalCount:function(){return this._dataModel.get("totalCount")},getCollections:function(){var e=this.getInputParam("offset"),t=this.getInputParam("limit"),n=this._dataModel.get("collections").getSubset(e*t,t);return n?n:(this.fetch(e,t),!1)}});return i});