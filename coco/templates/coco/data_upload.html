{% include "internal-tools/header.html" %}
<script type="text/javascript"  src="{{STATIC_URL}}social_website/scripts/libs/external/jquery-1.12.4.min.js"></script>
<script type="text/javascript"  src="{{STATIC_URL}}coco/app/scripts/libs/jquery.validate.js"></script>
<script type="text/javascript" src="{{STATIC_URL}}coco/app/scripts/libs/additional-methods.js"></script>
<style type="text/css">
  .errorlist{
    color: red;
  }
  .error{
    color: red;
  }
</style>

<section id="upload-data" class="about-bg">

  <div class="wrapper">
    <div class="inner-wrapper">
      <span><h2 class="hdg-a hdg-source-lt layout-vr-md" style="display: inline;">COCO - Upload Data</h2>
      <a href="{% url 'getfileheader' %}" id="header-download" class="btn btn-primary" style="margin-left: 50px;">Download File Header</a></span>
        {% for message in messages %}
          <div class="errorlist alert alert-success" role="alert">
              {{ message }}
          </div>
        {% endfor %}
      <div class="row">
        <div class="col-sm-12">
            <form id="data-upload" class="form-horizontal" action="" method="post" enctype="multipart/form-data">
              {% csrf_token %}
              <div class="control-group">
                {% if form.datafile.errors %}{{ form.datafile.errors}}{% endif %}
                <label class="control-label col-sm-2" for="datafile"></label>
                <div {% if form.datafile.errors %} class="col-sm-8" {% else %} class="col-sm-8" {% endif %} style="margin-top: 7px;">
                  {{ form.datafile }}
                </div>
              </div>
              <br>
              <br>
              <button type="submit" id="upload" class="btn btn-success">Submit</button>


            </form>
        </div>
        <br>
      </div>
    </div> <!-- End .inner-wrapper -->
  </div> <!-- End .wrapper -->
</section>

<script>
  var maxSizeExceeded = false;
  $("#id_datafile").change(function () {
    $('#id_datafile-error').html('');
    if(this.files[0].size / 1024 / 1024 > 2){
        maxSizeExceeded = true;
      }
    else
      maxSizeExceeded = false;
  });

$('form').validate({
   ignore: [],
   rules:{
       datafile: {
            required: true,
            extension: "csv"
        }
   },
   messages:{
       datafile:{
          required:"Please upload the file",
          extension:"Please upload a Valid file"
        }
   },
   submitHandler: function(form) {
    if(!maxSizeExceeded){
      form.submit();
      }
    else{
      alert('Max upload limit is 2 MB');
    }
    }
})

</script>

{% include "internal-tools/footer.html" %}
